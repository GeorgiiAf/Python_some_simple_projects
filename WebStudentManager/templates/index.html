<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Management</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body class="bg-light">
<div class="container py-4">
    <h1 class="text-center mb-4">Student Management</h1>

    <!-- Section for searching students -->
    <div id="search-section" class="card mb-4">
        <div class="card-body">
            <h2 class="card-title h4 mb-3">Search Students</h2>
            <div class="input-group">
                <input type="text" id="search" class="form-control" placeholder="Enter first or last name">
                <button class="btn btn-primary search-btn">Search</button>
                <button class="btn btn-secondary refresh-btn">Show All</button>
            </div>
        </div>
    </div>

    <!-- Student list -->
    <div id="student-list" class="card mb-4">
        <div class="card-body">
            <h2 class="card-title h4 mb-3">Student List</h2>
            <div class="table-responsive">
                <table id="students-table" class="table table-striped table-hover">
                    <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th data-sort="name">First Name <span class="sort-icon">↕</span></th>
                        <th data-sort="surname">Last Name <span class="sort-icon">↕</span></th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Student data will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal window for displaying student record book -->
    <div id="student-modal" class="modal fade">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title h4">Student Record Book: <span id="student-id-display"></span></h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table id="grades-table" class="table table-striped">
                            <thead>
                            <tr>
                                <th data-sort="subject">Subject <span class="sort-icon">↕</span></th>
                                <th>ID</th>
                                <th data-sort="date">Date <span class="sort-icon">↕</span></th>
                                <th data-sort="grade">Grade <span class="sort-icon">↕</span></th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            <!-- Student grades will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>

                    <h3 class="h5 mt-4 mb-3">Add Grade</h3>
                    <form class="grade-form">
                        <div class="mb-3">
                            <input type="text" id="modal-subject-name" class="form-control" placeholder="Subject Name" required>
                        </div>
                        <div class="mb-3">
                            <input type="number" id="modal-subject-grade" class="form-control" placeholder="Grade" min="1" max="5" required>
                        </div>
                        <div class="mb-3">
                            <input type="date" id="modal-subject-date" class="form-control" required>
                        </div>
                        <button type="button" id="add-grade-btn" class="btn btn-primary">Add Grade</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Section for adding a new student -->
    <div id="add-student-section" class="card">
        <div class="card-body">
            <h2 class="card-title h4 mb-3">Add Student</h2>
            <form id="add-student-form">
                <div class="mb-3">
                    <input type="text" id="name-input" class="form-control" placeholder="First Name" required>
                </div>
                <div class="mb-3">
                    <input type="text" id="surname-input" class="form-control" placeholder="Last Name" required>
                </div>
                <div class="mb-3">
                    <input type="text" id="student-id-input" class="form-control" placeholder="Record Book Number" required>
                </div>
                <button type="submit" class="btn btn-primary">Add Student</button>
            </form>
        </div>
    </div>
</div>

<!-- Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Global functions -->
<script type="module">
    import { 
        viewStudentDetails as showGrades, 
        deleteGrade, 
        editGrade,
        saveGradeChanges,
        cancelGradeEdit 
    } from './static/js/gradeService.js';
    import { deleteStudent } from './static/js/studentService.js';

    // Make functions globally available
    window.showGrades = showGrades;
    window.deleteGrade = deleteGrade;
    window.deleteStudent = deleteStudent;
    window.editGrade = editGrade;
    window.saveGradeChanges = saveGradeChanges;
    window.cancelGradeEdit = cancelGradeEdit;
</script>
<script type="module" src="/static/js/main.js"></script>
</body>
</html>